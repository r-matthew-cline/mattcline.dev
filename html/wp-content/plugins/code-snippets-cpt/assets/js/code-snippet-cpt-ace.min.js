/** Code Snippets CPT - v2.1.0 - 2017-04-05 | http://dsgnwrks.pro | Copyright (c) 2017; | Licensed GPLv2+ **/
window.snippetcpt=window.snippetcpt||{},function(a,b,c,d,e,f){"use strict";c.extend(e,a.snippetcptAce);var g=null;e.viewers=[],e.aceInitComplete=!1,e.aceAfterRenderComplete=!1,e.newViewer=function(f){var h={toolbarDelay:500,isCollapsed:null,editor:null};h.cache=function(){h.$snippet=c(f),h.$wrap=h.$snippet.parent(),h.data=h.$snippet.data("config")},h.init=function(){h.cache(),h.editor=d.edit(f),h.editor.setOptions({readOnly:!0,showPrintMargin:!1,highlightActiveLine:!1,maxLines:"auto"===h.data.max_lines?1/0:h.data.max_lines,minLines:1});var a=h.editor.getSession();h.editor.setTheme(e.theme||"ace/theme/chrome"),h.data.lang?"php"===h.data.lang&&0!==a.getValue().trim().indexOf("<?php")?a.setMode({path:"ace/mode/php",inline:!0}):a.setMode("ace/mode/"+h.data.lang):a.setMode(e.language||"ace/mode/text"),h.data.line_nums||h.editor.renderer.setShowGutter(!1),h.editor.renderer.on("afterRender",h.triggerRender),h.$wrap.on("click",".line-numbers",h.toggleLineNumbers),"auto"===h.data.max_lines&&h.$wrap.removeClass("scrollable"),e.features.collapsible&&h.$wrap.on("click",".collapse",h.toggleCollapse),h.$snippet.trigger("snippetcpt-ace-init")},h.triggerRender=function(){g&&a.clearTimeout(g),g=setTimeout(function(){e.aceAfterRenderComplete=!0,c(b.body).trigger("snippetcpt-afterRender"),h.editor.renderer.off("resize",h.triggerRender)},500)},h.toggleLineNumbers=function(a){a.preventDefault(),h.data.lineNums?(h.editor.renderer.setShowGutter(!1),h.data.lineNums=!1,h.$wrap.find(".snippet-buttons .line-numbers").removeClass("has-line-numbers")):(h.editor.renderer.setShowGutter(!0),h.data.lineNums=!0,h.$wrap.find(".snippet-buttons .line-numbers").addClass("has-line-numbers"))},h.toggleCollapse=function(a){a.preventDefault(),h.isCollapsed?(h.isCollapsed=!1,h.$snippet.slideDown(),h.$snippet.parent().removeClass("snippetcpt-hidden"),c(this).addClass("dashicons-hidden").removeClass("dashicons-visibility")):(h.isCollapsed=!0,h.$snippet.slideUp(),h.$snippet.parent().addClass("snippetcpt-hidden"),c(this).addClass("dashicons-visibility").removeClass("dashicons-hidden"))},e.viewers.push(h),h.init()},e.init=function(){c(".snippetcpt-ace-viewer").each(function(){e.newViewer(this)}),e.aceInitComplete=!0,c(b.body).trigger("snippetcpt-ace-init-complete")},c(e.init)}(window,document,jQuery,window.ace,window.snippetcpt),window.snippetcpt=window.snippetcpt||{},function(a,b,c,d,e){"use strict";c.extend(d,a.snippetcptl10n),d.$=d.$||{};var f=d.$,g=27,h=[],i='<span class="snippet-button dashicons {{ data.class }}" title="{{ data.title }}"></span>',j='<a href="{{ data.link }}" class="snippet-button dashicons {{ data.class }}" title="{{ data.title }}"></a>',k={copy:{class:"dashicons-editor-code",title:d.l10n.copy},fullscreen:{class:"dashicons-editor-expand",title:d.l10n.fullscreen},close:{class:"dashicons-no",title:d.l10n.close},edit:{class:"dashicons-edit",title:d.l10n.edit},collapse:{class:"dashicons-hidden collapse",title:d.l10n.collapse},numbers:{class:"dashicons-editor-ol line-numbers",title:d.l10n.numbers}};d.init=function(){f.wrap=c(".snippetcpt-wrap"),f.body=c(b.body),c(b).on("prettify-loaded",d.prettifyLoaded),d.features.edit&&h.push("edit"),d.features.do_click_to_copy&&d.clickToCopyInit(),d.features.enable_full_screen_view&&d.fullScreenInit(),d.features.enable_ace&&(h.push("numbers"),d.features.collapsible&&h.push("collapse")),d.addIcons(h)&&f.body.trigger("snippet-icons-added"),d.features.enable_full_screen_view&&d.fullscreen&&f.body.one("snippetcpt-afterRender",function(){f.body.find(".snippet-button.dashicons-editor-expand").first().trigger("click")})},d.prettifyLoaded=function(){f.wrap.each(function(){var a=c(this),b=a.find(".linenums li").length;b>1e3&&a.addClass("gt1000"),b>100&&a.addClass("gt100"),b>10&&a.addClass("gt10")})},d.addIcons=function(a){var b=!1;return f.wrap.each(function(){for(var e=c(this),f="",g=0;g<a.length;g++)"fullscreen"===a[g]&&e.parent(".snippetcpt-footer").length&&(a[g]="close"),f+=d.getIcon(a[g],e.data(a[g]));f&&(b=!0,e.find(".snippet-buttons").length||e.append('<div class="snippet-buttons"></div>')),c(this).find(".snippet-buttons").append(f)}),b},d.getIcon=function(a,b){var e="";switch(a){case"close":case"collapse":case"numbers":e=d.template(k[a],i);break;default:b&&(e=d.template(c.extend(k[a],{link:b}),j))}return e},d.template=function(a,b){return c.each(a,function(a,c){b=b.replace(new RegExp("{{ data."+a+" }}","gi"),c)}),b},d.clickToCopyInit=function(){h.push("copy"),f.body.on("click",".snippet-button.dashicons-editor-code",d.browserCopy).on("snippet-icons-added",function(){setTimeout(d.cacheCopyable,500)})},d.cacheCopyable=function(){c(".snippetcpt-wrap").each(function(){var a=c(this),b=a.attr("id")+"-copy",e=a.data("copy")+"&json=1",g=function(){d.debug&&console.log("get fail",arguments)};c.get(e).success(function(d){if(d.success){var e=c('<div style="display:none" id="'+b+'"></div>');e.text(d.data),f.body.append(e),a.data("copyId",b)}else g(d)}).fail(g)})},d.browserCopy=function(e){var f=c(this),g=f.parents(".snippetcpt-wrap");if(!g.data("copyId"))return d.snippetCopyWindow(f.attr("href"),e);g.find(".copy-success-msg").length||g.find(".snippet-buttons").append('<div class="copy-success-msg">'+d.l10n.copied+"</div>");var h=d.copyText(c(b.getElementById(g.data("copyId"))).text());return a.wp&&a.wp.a11y&&a.wp.a11y.speak(h?d.l10n.copied:d.l10n.copyError,"assertive"),h?(e.preventDefault(),f.removeClass("dashicons-editor-code").addClass("dashicons-thumbs-up"),g.addClass("snippet-copied-success"),setTimeout(function(){f.removeClass("dashicons-thumbs-up").addClass("dashicons-editor-code"),g.removeClass("snippet-copied-success")},1500),!0):d.snippetCopyWindow(f.attr("href"),e)},d.copyText=function(a){var c=!1,e=function(a){var c=b.createElement("pre");return c.style.width="1px",c.style.height="1px",c.style.position="fixed",c.style.top="5px",c.textContent=a,c},f=function(a){var e=getSelection();e.removeAllRanges();var f=b.createRange();f.selectNodeContents(a),e.addRange(f);try{c=b.execCommand("copy")}catch(a){d.debug&&(console.log(d.l10n.copyError),console.log(a))}e.removeAllRanges()},g=e(a);return b.body.appendChild(g),f(g),b.body.removeChild(g),c},d.snippetCopyWindow=function(b,c){var e=925,f=950,g=a.innerWidth/2-e/2,h=a.innerHeight/2-f/2;a.open(b,d.l10n.copy_code,"toolbar=no,resizable=yes,width="+e+",height="+f+",top="+h+",left="+g)&&c.preventDefault()},d.fullScreenInit=function(){h.push("fullscreen"),f.footer=c(".snippetcpt-footer"),f.footer.length||(f.footer=c('<div class="snippetcpt-footer snippet-hidden"></div>').appendTo(f.body)),f.body.on("click",".snippet-button.dashicons-no",d.closeSnippet).on("click",".snippet-button.dashicons-editor-expand",d.openSnippet),c(b).on("keyup",function(a){g===a.keyCode&&d.closeSnippet()}),d.isSnippet&&(d.url=a.location.pathname,d.isFull=!1,a.onpopstate=function(a){var b=d.fullscreen?"closed":"open",c=a.state&&a.state.was?a.state.was:b;d.isSnippet=!1,"closed"===c?f.body.find(".snippet-button.dashicons-editor-expand").first().trigger("click"):f.body.find(".snippet-button.dashicons-no").first().trigger("click"),d.isSnippet=!0})},d.closeSnippet=function(){d.isFull=!1,d.isSnippet&&a.history.pushState({was:"open"},"",d.url),f.body.removeClass("snippet-full-screen").removeClass("snippet-scrollable"),f.footer.html("").addClass("snippet-hidden")},d.openSnippet=function(b){b.preventDefault(),d.isFull=!0,d.isSnippet&&a.history.pushState({was:"closed"},"","?full-screen");var e=c(this).parents(".snippetcpt-wrap").clone(!0),g=e.find("pre");f.body.addClass("snippet-full-screen"),e.find(".dashicons-editor-expand").replaceWith(d.template(k.close,i)),g.show(),f.footer.html(e).removeClass("snippet-hidden"),(g.outerHeight()>c(a).height()||g.find(">").outerHeight()>c(a).height())&&f.body.addClass("snippet-scrollable"),f.body.trigger("snippet-full-screen")},c(d.init)}(window,document,jQuery,window.snippetcpt);